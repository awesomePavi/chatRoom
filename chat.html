<!doctype html>
<html>
<head>
  <title>Chat v1.0</title>
  <style>
    span:nth-child(even) {
      background-color: #EDEDED;
    }
    span:nth-child(odd) {
      background-color: #FeFeFe;
    }

    /* Fix send bar to top of page*/
    #formSend{
      position: fixed; 
      top: 0; 
      width: 100%; 
    }
  </style>
  <script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
  <script src="http://code.jquery.com/jquery-1.11.1.js"></script>
</head>
<!-- Get username on page load -->
<body onload="getName()">

<!-- Send Messages -->
  <form id="formSend" action="" >
    <input id="m" autocomplete="on" style="width: 90%;" placeholder="Enter Message"></input>
    <button style="width: 7%;">Send</button>
  </form>
  <div id="messages" style="width: 100%; padding: 0; margin-top: 20px">

  </div>
  

  <script type="text/javascript">
   colorName = {server:"#FF0000"};
   username = "Undefined"; 


    //prompt for name on start
    function getName() {
      var person = prompt("Please enter your name", "");
      if (person.length > 2 && person.length < 16) {
        console.log(person);
        console.log(person.length);
        username = person;
        colorName[username] = "#00FF00";
        console.log(colorName); 
      }else if(person.length <= 2){
        alert("Minimum Length is 3 characters.")
        getName();
      }else if(person.length >= 16){
        alert("Maximum Length is 15 characters.")
        getName();
      }else{
        getName();
      }
      
    }

    //display Message
    function dispMsg(nme, msg){
      //if new user
      if(!colorName[nme]) {
        colorName[nme] =  "#"+((1<<24)*Math.random()|0).toString(16);
      }

    
      var holder = document.createElement("span");
      holder.setAttribute("style", "display: block; padding: 2px");
      var name = document.createElement("a");
      name.style.color = colorName[nme];
      name.style.width = "10%";

      name.innerHTML = nme;
      var spacer = document.createElement("a");
      spacer.innerHTML = "  :  ";
      var message = document.createElement("a");
      message.innerHTML = msg;
      message.style.width = "80%";
      var newLine = document.createElement("br");

      holder.appendChild(name);
      holder.appendChild(spacer);
      holder.appendChild(message);
      document.getElementById("messages").appendChild(holder);
    }

    //get socket information
    var socket = io();
    // submit message
    $('form').submit(function(){
      //send message via socket
      socket.emit('message', username ,$('#m').val());
      $('#m').val('');
      return false;
    });
    //on message recieve
    socket.on('message', function(name,msg){
      dispMsg(name,msg);
    });
  </script>

</body>
</html>